{"changed":true,"filter":false,"title":"main.tf","tooltip":"/terraform-aws-eks/02_EKS/eks_managed_node_group/main.tf","value":"provider \"aws\" {\n  region = local.region\n}\n\nprovider \"kubernetes\" {\n  host                   = module.eks.cluster_endpoint\n  cluster_ca_certificate = base64decode(module.eks.cluster_certificate_authority_data)\n\n  exec {\n    api_version = \"client.authentication.k8s.io/v1beta1\"\n    command     = \"aws\"\n    # This requires the awscli to be installed locally where Terraform is executed\n    args = [\"eks\", \"get-token\", \"--cluster-name\", module.eks.cluster_name]\n  }\n}\n\n\n\ndata \"aws_caller_identity\" \"current\" {}\ndata \"aws_availability_zones\" \"available\" {}\n\nlocals {\n  name            = \"eyjo-${replace(basename(path.cwd), \"_\", \"-\")}\"\n  cluster_version = \"1.27\"\n  region          = \"ap-northeast-2\"\n\n  tags = {\n    Example    = local.name\n    GithubRepo = \"terraform-aws-eks\"\n    GithubOrg  = \"terraform-aws-modules\"\n  }\n}\n\n\n\n################################################################################\n# Remote_State \n################################################################################\n\n\ndata \"terraform_remote_state\" \"vpc\" {\n  backend = \"local\"\n\n  config = {\n    path = \"../../01_VPC/examples/complete/terraform.tfstate\"\n  }\n}\n\n\n################################################################################\n# EKS Module\n################################################################################\n\nmodule \"eks\" {\n  source = \"../..\"\n\n  cluster_name                   = local.name\n  cluster_version                = local.cluster_version\n  cluster_endpoint_public_access = true\n\n  # IPV6\n  cluster_ip_family = \"ipv4\"\n\n  # We are using the IRSA created below for permissions\n  # However, we have to deploy with the policy attached FIRST (when creating a fresh cluster)\n  # and then turn this off after the cluster/node group is created. Without this initial policy,\n  # the VPC CNI fails to assign IPs and nodes cannot join the cluster\n  # See https://github.com/aws/containers-roadmap/issues/1666 for more context\n  # TODO - remove this policy once AWS releases a managed version similar to AmazonEKS_CNI_Policy (IPv4)\n  #create_cni_ipv6_iam_policy = true\n\n  cluster_addons = {\n    coredns = {\n      most_recent = true\n    }\n    kube-proxy = {\n      most_recent = true\n    }\n    vpc-cni = {\n      most_recent              = true\n      before_compute           = true\n      service_account_role_arn = module.vpc_cni_irsa.iam_role_arn\n      configuration_values = jsonencode({\n        env = {\n          # Reference docs https://docs.aws.amazon.com/eks/latest/userguide/cni-increase-ip-addresses.html\n          ENABLE_PREFIX_DELEGATION = \"true\"\n          WARM_PREFIX_TARGET       = \"1\"\n        }\n      })\n    }\n  }\n\n  vpc_id                   = data.terraform_remote_state.vpc.outputs.vpc_id\n  subnet_ids               = data.terraform_remote_state.vpc.outputs.private_subnets\n  control_plane_subnet_ids = data.terraform_remote_state.vpc.outputs.intra_subnets\n\n  manage_aws_auth_configmap = true\n\n  eks_managed_node_group_defaults = {\n    ami_type       = \"AL2_x86_64\"\n    #instance_types = [\"t3.medium\"]\n\n    # We are using the IRSA created below for permissions\n    # However, we have to deploy with the policy attached FIRST (when creating a fresh cluster)\n    # and then turn this off after the cluster/node group is created. Without this initial policy,\n    # the VPC CNI fails to assign IPs and nodes cannot join the cluster\n    # See https://github.com/aws/containers-roadmap/issues/1666 for more context\n    iam_role_attach_cni_policy = true\n  }\n\n  eks_managed_node_groups = {\n    # blue = {}\n    custom_node_group = {\n      min_size     = 1\n      max_size     = 4\n      desired_size = 3\n\n      instance_types = [\"t3.medium\"]\n      capacity_type  = \"SPOT\"\n      labels = {\n        Environment = \"test\"\n        GithubRepo  = \"terraform-aws-eks\"\n        GithubOrg   = \"terraform-aws-modules\"\n      }\n\n    #   taints = {\n    #     dedicated = {\n    #       key    = \"dedicated\"\n    #       value  = \"gpuGroup\"\n    #       effect = \"NO_SCHEDULE\"\n    #     }\n\n\n      block_device_mappings = {\n        xvda = {\n          device_name = \"/dev/xvda\"\n          ebs = {\n            volume_size           = 110\n            volume_type           = \"gp3\"\n            iops                  = 3000\n            throughput            = 150\n            delete_on_termination = true\n          }\n        }\n      }\n\n      update_config = {\n        max_unavailable_percentage = 33 # or set `max_unavailable`\n      }\n\n      tags = {\n        ExtraTag = \"example\"\n      }\n    }\n    \n    # custom_node_group_2 = {\n    #   min_size     = 1\n    #   max_size     = 2\n    #   desired_size = 1\n\n    #   instance_types = [\"t3.small\"]\n    #   capacity_type  = \"SPOT\"\n    #   labels = {\n    #     Environment = \"test\"\n    #     GithubRepo  = \"terraform-aws-eks\"\n    #     GithubOrg   = \"terraform-aws-modules\"\n    #   }\n\n    # #   taints = {\n    # #     dedicated = {\n    # #       key    = \"dedicated\"\n    # #       value  = \"gpuGroup\"\n    # #       effect = \"NO_SCHEDULE\"\n    # #     }\n\n\n    #   block_device_mappings = {\n    #     xvda = {\n    #       device_name = \"/dev/xvda\"\n    #       ebs = {\n    #         volume_size           = 100\n    #         volume_type           = \"gp3\"\n    #         iops                  = 3000\n    #         throughput            = 150\n    #         delete_on_termination = true\n    #       }\n    #     }\n    #   }\n\n    #   update_config = {\n    #     max_unavailable_percentage = 33 # or set `max_unavailable`\n    #   }\n\n    #   tags = {\n    #     ExtraTag = \"example\"\n    #   }\n      \n    # #custom_node_group_2\n    # }\n    \n    #eks_managed_node_groups\n    }\n    \n#EKS()    \n}\n\nmodule \"vpc_cni_irsa\" {\n  source  = \"terraform-aws-modules/iam/aws//modules/iam-role-for-service-accounts-eks\"\n  version = \"~> 5.0\"\n\n  role_name_prefix      = \"VPC-CNI-IRSA\"\n  attach_vpc_cni_policy = true\n  vpc_cni_enable_ipv4 = true\n  #vpc_cni_enable_ipv6   = false\n\n  oidc_providers = {\n    main = {\n      provider_arn               = module.eks.oidc_provider_arn\n      namespace_service_accounts = [\"kube-system:aws-node\"]\n    }\n  }\n\n  tags = local.tags\n}\n\nmodule \"ebs_kms_key\" {\n  source  = \"terraform-aws-modules/kms/aws\"\n  version = \"~> 1.5\"\n\n  description = \"Customer managed key to encrypt EKS managed node group volumes\"\n\n  # Policy\n  key_administrators = [\n    data.aws_caller_identity.current.arn\n  ]\n\n  key_service_roles_for_autoscaling = [\n    # required for the ASG to manage encrypted volumes for nodes\n    \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:role/aws-service-role/autoscaling.amazonaws.com/AWSServiceRoleForAutoScaling\",\n    # required for the cluster / persistentvolume-controller to create encrypted PVCs\n    module.eks.cluster_iam_role_arn,\n  ]\n\n  # Aliases\n  aliases = [\"eks/${local.name}/ebs\"]\n\n  tags = local.tags\n}\n\n\nmodule \"key_pair\" {\n  source  = \"terraform-aws-modules/key-pair/aws\"\n  version = \"~> 2.0\"\n\n  key_name_prefix    = local.name\n  create_private_key = true\n\n  tags = local.tags\n}\n\nresource \"aws_security_group\" \"remote_access\" {\n  name_prefix = \"${local.name}-remote-access\"\n  description = \"Allow remote SSH access\"\n  vpc_id      = data.terraform_remote_state.vpc.outputs.vpc_id\n\n  ingress {\n    description = \"SSH access\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"10.0.0.0/8\"]\n  }\n\n  egress {\n    from_port        = 0\n    to_port          = 0\n    protocol         = \"-1\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n    ipv6_cidr_blocks = [\"::/0\"]\n  }\n\n  tags = merge(local.tags, { Name = \"${local.name}-remote\" })\n}\n\nresource \"aws_iam_policy\" \"node_additional\" {\n  name        = \"${local.name}-additional\"\n  description = \"Example usage of node additional policy\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = [\n          \"ec2:Describe*\",\n        ]\n        Effect   = \"Allow\"\n        Resource = \"*\"\n      },\n    ]\n  })\n\n  tags = local.tags\n}\n\ndata \"aws_ami\" \"eks_default\" {\n  most_recent = true\n  owners      = [\"amazon\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"amazon-eks-node-${local.cluster_version}-v*\"]\n  }\n}\n\n# data \"aws_ami\" \"eks_default_arm\" {\n#   most_recent = true\n#   owners      = [\"amazon\"]\n\n#   filter {\n#     name   = \"name\"\n#     values = [\"amazon-eks-arm64-node-${local.cluster_version}-v*\"]\n#   }\n# }\n\n# data \"aws_ami\" \"eks_default_bottlerocket\" {\n#   most_recent = true\n#   owners      = [\"amazon\"]\n\n#   filter {\n#     name   = \"name\"\n#     values = [\"bottlerocket-aws-k8s-${local.cluster_version}-x86_64-*\"]\n#   }\n# }\n\n\n################################################################################\n# Tags for the ASG to support cluster-autoscaler scale up from 0\n################################################################################\n\nlocals {\n  # We need to lookup K8s taint effect from the AWS API value\n  taint_effects = {\n    NO_SCHEDULE        = \"NoSchedule\"\n    NO_EXECUTE         = \"NoExecute\"\n    PREFER_NO_SCHEDULE = \"PreferNoSchedule\"\n  }\n\n  cluster_autoscaler_label_tags = merge([\n    for name, group in module.eks.eks_managed_node_groups : {\n      for label_name, label_value in coalesce(group.node_group_labels, {}) : \"${name}|label|${label_name}\" => {\n        autoscaling_group = group.node_group_autoscaling_group_names[0],\n        key               = \"k8s.io/cluster-autoscaler/node-template/label/${label_name}\",\n        value             = label_value,\n      }\n    }\n  ]...)\n\n  cluster_autoscaler_taint_tags = merge([\n    for name, group in module.eks.eks_managed_node_groups : {\n      for taint in coalesce(group.node_group_taints, []) : \"${name}|taint|${taint.key}\" => {\n        autoscaling_group = group.node_group_autoscaling_group_names[0],\n        key               = \"k8s.io/cluster-autoscaler/node-template/taint/${taint.key}\"\n        value             = \"${taint.value}:${local.taint_effects[taint.effect]}\"\n      }\n    }\n  ]...)\n\n  cluster_autoscaler_asg_tags = merge(local.cluster_autoscaler_label_tags, local.cluster_autoscaler_taint_tags)\n}\n\nresource \"aws_autoscaling_group_tag\" \"cluster_autoscaler_label_tags\" {\n  for_each = local.cluster_autoscaler_asg_tags\n\n  autoscaling_group_name = each.value.autoscaling_group\n\n  tag {\n    key   = each.value.key\n    value = each.value.value\n\n    propagate_at_launch = false\n  }\n}\n","undoManager":{"mark":95,"position":100,"stack":[[{"start":{"row":159,"column":0},"end":{"row":159,"column":1},"action":"insert","lines":["}"],"id":406}],[{"start":{"row":158,"column":0},"end":{"row":158,"column":1},"action":"remove","lines":[" "],"id":407},{"start":{"row":157,"column":5},"end":{"row":158,"column":3},"action":"remove","lines":["","   "]}],[{"start":{"row":84,"column":4},"end":{"row":84,"column":6},"action":"remove","lines":["# "],"id":408},{"start":{"row":85,"column":4},"end":{"row":85,"column":6},"action":"remove","lines":["# "]},{"start":{"row":86,"column":4},"end":{"row":86,"column":6},"action":"remove","lines":["# "]},{"start":{"row":87,"column":4},"end":{"row":87,"column":6},"action":"remove","lines":["# "]},{"start":{"row":88,"column":4},"end":{"row":88,"column":6},"action":"remove","lines":["# "]},{"start":{"row":89,"column":4},"end":{"row":89,"column":6},"action":"remove","lines":["# "]},{"start":{"row":90,"column":4},"end":{"row":90,"column":6},"action":"remove","lines":["# "]},{"start":{"row":91,"column":4},"end":{"row":91,"column":6},"action":"remove","lines":["# "]},{"start":{"row":92,"column":4},"end":{"row":92,"column":6},"action":"remove","lines":["# "]}],[{"start":{"row":73,"column":24},"end":{"row":74,"column":0},"action":"insert","lines":["",""],"id":409},{"start":{"row":74,"column":0},"end":{"row":74,"column":6},"action":"insert","lines":["      "]},{"start":{"row":74,"column":6},"end":{"row":74,"column":7},"action":"insert","lines":["r"]},{"start":{"row":74,"column":7},"end":{"row":74,"column":8},"action":"insert","lines":["e"]},{"start":{"row":74,"column":8},"end":{"row":74,"column":9},"action":"insert","lines":["o"]},{"start":{"row":74,"column":9},"end":{"row":74,"column":10},"action":"insert","lines":["s"]},{"start":{"row":74,"column":10},"end":{"row":74,"column":11},"action":"insert","lines":["l"]}],[{"start":{"row":74,"column":10},"end":{"row":74,"column":11},"action":"remove","lines":["l"],"id":410}],[{"start":{"row":74,"column":10},"end":{"row":74,"column":11},"action":"insert","lines":["o"],"id":411},{"start":{"row":74,"column":11},"end":{"row":74,"column":12},"action":"insert","lines":["l"]}],[{"start":{"row":74,"column":11},"end":{"row":74,"column":12},"action":"remove","lines":["l"],"id":412},{"start":{"row":74,"column":10},"end":{"row":74,"column":11},"action":"remove","lines":["o"]},{"start":{"row":74,"column":9},"end":{"row":74,"column":10},"action":"remove","lines":["s"]},{"start":{"row":74,"column":8},"end":{"row":74,"column":9},"action":"remove","lines":["o"]}],[{"start":{"row":74,"column":8},"end":{"row":74,"column":9},"action":"insert","lines":["s"],"id":413},{"start":{"row":74,"column":9},"end":{"row":74,"column":10},"action":"insert","lines":["o"]},{"start":{"row":74,"column":10},"end":{"row":74,"column":11},"action":"insert","lines":["l"]},{"start":{"row":74,"column":11},"end":{"row":74,"column":12},"action":"insert","lines":["v"]},{"start":{"row":74,"column":12},"end":{"row":74,"column":13},"action":"insert","lines":["e"]},{"start":{"row":74,"column":13},"end":{"row":74,"column":14},"action":"insert","lines":["_"]},{"start":{"row":74,"column":14},"end":{"row":74,"column":15},"action":"insert","lines":["c"]},{"start":{"row":74,"column":15},"end":{"row":74,"column":16},"action":"insert","lines":["o"]},{"start":{"row":74,"column":16},"end":{"row":74,"column":17},"action":"insert","lines":["n"]},{"start":{"row":74,"column":17},"end":{"row":74,"column":18},"action":"insert","lines":["f"]}],[{"start":{"row":74,"column":18},"end":{"row":74,"column":19},"action":"insert","lines":["l"],"id":414},{"start":{"row":74,"column":19},"end":{"row":74,"column":20},"action":"insert","lines":["i"]},{"start":{"row":74,"column":20},"end":{"row":74,"column":21},"action":"insert","lines":["c"]},{"start":{"row":74,"column":21},"end":{"row":74,"column":22},"action":"insert","lines":["t"]},{"start":{"row":74,"column":22},"end":{"row":74,"column":23},"action":"insert","lines":["s"]}],[{"start":{"row":74,"column":23},"end":{"row":74,"column":24},"action":"insert","lines":[" "],"id":415},{"start":{"row":74,"column":24},"end":{"row":74,"column":25},"action":"insert","lines":["="]}],[{"start":{"row":74,"column":25},"end":{"row":74,"column":26},"action":"insert","lines":[" "],"id":416}],[{"start":{"row":74,"column":26},"end":{"row":74,"column":28},"action":"insert","lines":["\"\""],"id":417}],[{"start":{"row":74,"column":27},"end":{"row":74,"column":28},"action":"insert","lines":["O"],"id":418},{"start":{"row":74,"column":28},"end":{"row":74,"column":29},"action":"insert","lines":["V"]},{"start":{"row":74,"column":29},"end":{"row":74,"column":30},"action":"insert","lines":["E"]},{"start":{"row":74,"column":30},"end":{"row":74,"column":31},"action":"insert","lines":["R"]},{"start":{"row":74,"column":31},"end":{"row":74,"column":32},"action":"insert","lines":["W"]},{"start":{"row":74,"column":32},"end":{"row":74,"column":33},"action":"insert","lines":["R"]},{"start":{"row":74,"column":33},"end":{"row":74,"column":34},"action":"insert","lines":["I"]},{"start":{"row":74,"column":34},"end":{"row":74,"column":35},"action":"insert","lines":["T"]},{"start":{"row":74,"column":35},"end":{"row":74,"column":36},"action":"insert","lines":["E"]}],[{"start":{"row":74,"column":36},"end":{"row":74,"column":38},"action":"insert","lines":["\"\""],"id":419}],[{"start":{"row":74,"column":36},"end":{"row":74,"column":38},"action":"remove","lines":["\"\""],"id":420}],[{"start":{"row":74,"column":36},"end":{"row":74,"column":37},"action":"remove","lines":["\""],"id":421}],[{"start":{"row":74,"column":36},"end":{"row":74,"column":37},"action":"insert","lines":["\""],"id":422}],[{"start":{"row":74,"column":0},"end":{"row":74,"column":37},"action":"remove","lines":["      resolve_conflicts = \"OVERWRITE\""],"id":423},{"start":{"row":73,"column":24},"end":{"row":74,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":74,"column":0},"end":{"row":77,"column":7},"action":"remove","lines":["      timeouts = {","      create = \"25m\"","      delete = \"10m\"","      }"],"id":424},{"start":{"row":73,"column":24},"end":{"row":74,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":161,"column":30},"end":{"row":162,"column":0},"action":"insert","lines":["",""],"id":425},{"start":{"row":162,"column":0},"end":{"row":162,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":162,"column":2},"end":{"row":162,"column":3},"action":"insert","lines":["v"],"id":426},{"start":{"row":162,"column":3},"end":{"row":162,"column":4},"action":"insert","lines":["p"]},{"start":{"row":162,"column":4},"end":{"row":162,"column":5},"action":"insert","lines":["c"]},{"start":{"row":162,"column":5},"end":{"row":162,"column":6},"action":"insert","lines":["_"]},{"start":{"row":162,"column":6},"end":{"row":162,"column":7},"action":"insert","lines":["c"]}],[{"start":{"row":162,"column":7},"end":{"row":162,"column":8},"action":"insert","lines":["n"],"id":427},{"start":{"row":162,"column":8},"end":{"row":162,"column":9},"action":"insert","lines":["i"]}],[{"start":{"row":162,"column":2},"end":{"row":162,"column":9},"action":"remove","lines":["vpc_cni"],"id":428},{"start":{"row":162,"column":2},"end":{"row":162,"column":21},"action":"insert","lines":["vpc_cni_enable_ipv6"]}],[{"start":{"row":162,"column":20},"end":{"row":162,"column":21},"action":"remove","lines":["6"],"id":429}],[{"start":{"row":162,"column":20},"end":{"row":162,"column":21},"action":"insert","lines":["4"],"id":430}],[{"start":{"row":162,"column":21},"end":{"row":162,"column":22},"action":"insert","lines":[" "],"id":431},{"start":{"row":162,"column":22},"end":{"row":162,"column":23},"action":"insert","lines":["="]}],[{"start":{"row":162,"column":23},"end":{"row":162,"column":24},"action":"insert","lines":[" "],"id":432},{"start":{"row":162,"column":24},"end":{"row":162,"column":25},"action":"insert","lines":["t"]},{"start":{"row":162,"column":25},"end":{"row":162,"column":26},"action":"insert","lines":["r"]},{"start":{"row":162,"column":26},"end":{"row":162,"column":27},"action":"insert","lines":["u"]},{"start":{"row":162,"column":27},"end":{"row":162,"column":28},"action":"insert","lines":["e"]}],[{"start":{"row":162,"column":28},"end":{"row":162,"column":29},"action":"insert","lines":[" "],"id":433}],[{"start":{"row":162,"column":28},"end":{"row":162,"column":29},"action":"remove","lines":[" "],"id":434}],[{"start":{"row":154,"column":0},"end":{"row":154,"column":4},"action":"insert","lines":["    "],"id":435}],[{"start":{"row":154,"column":0},"end":{"row":154,"column":4},"action":"remove","lines":["    "],"id":436}],[{"start":{"row":153,"column":4},"end":{"row":153,"column":5},"action":"remove","lines":["}"],"id":437},{"start":{"row":153,"column":0},"end":{"row":153,"column":4},"action":"remove","lines":["    "]},{"start":{"row":152,"column":7},"end":{"row":153,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":152,"column":7},"end":{"row":153,"column":0},"action":"insert","lines":["",""],"id":438},{"start":{"row":153,"column":0},"end":{"row":153,"column":6},"action":"insert","lines":["      "]},{"start":{"row":153,"column":6},"end":{"row":153,"column":7},"action":"insert","lines":["{"]}],[{"start":{"row":153,"column":6},"end":{"row":153,"column":7},"action":"remove","lines":["{"],"id":439}],[{"start":{"row":153,"column":6},"end":{"row":153,"column":7},"action":"insert","lines":["}"],"id":440}],[{"start":{"row":153,"column":5},"end":{"row":153,"column":6},"action":"remove","lines":[" "],"id":441}],[{"start":{"row":153,"column":4},"end":{"row":153,"column":5},"action":"remove","lines":[" "],"id":442}],[{"start":{"row":154,"column":1},"end":{"row":155,"column":0},"action":"insert","lines":["",""],"id":443},{"start":{"row":155,"column":0},"end":{"row":155,"column":1},"action":"insert","lines":["}"]}],[{"start":{"row":155,"column":0},"end":{"row":155,"column":1},"action":"remove","lines":["}"],"id":444},{"start":{"row":154,"column":1},"end":{"row":155,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":131,"column":6},"end":{"row":131,"column":7},"action":"remove","lines":["}"],"id":445},{"start":{"row":131,"column":5},"end":{"row":131,"column":6},"action":"remove","lines":[" "]},{"start":{"row":131,"column":4},"end":{"row":131,"column":5},"action":"remove","lines":[" "]},{"start":{"row":131,"column":0},"end":{"row":131,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":153,"column":5},"end":{"row":154,"column":0},"action":"insert","lines":["",""],"id":446},{"start":{"row":154,"column":0},"end":{"row":154,"column":4},"action":"insert","lines":["    "]},{"start":{"row":154,"column":4},"end":{"row":155,"column":0},"action":"insert","lines":["",""]},{"start":{"row":155,"column":0},"end":{"row":155,"column":4},"action":"insert","lines":["    "]},{"start":{"row":155,"column":4},"end":{"row":155,"column":5},"action":"insert","lines":["}"]}],[{"start":{"row":154,"column":0},"end":{"row":154,"column":4},"action":"remove","lines":["    "],"id":447},{"start":{"row":153,"column":5},"end":{"row":154,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":153,"column":4},"end":{"row":153,"column":8},"action":"insert","lines":["    "],"id":448}],[{"start":{"row":153,"column":4},"end":{"row":153,"column":8},"action":"remove","lines":["    "],"id":449}],[{"start":{"row":22,"column":22},"end":{"row":22,"column":23},"action":"remove","lines":["x"],"id":451},{"start":{"row":22,"column":21},"end":{"row":22,"column":22},"action":"remove","lines":["e"]}],[{"start":{"row":22,"column":21},"end":{"row":22,"column":22},"action":"insert","lines":["t"],"id":452},{"start":{"row":22,"column":22},"end":{"row":22,"column":23},"action":"insert","lines":["e"]},{"start":{"row":22,"column":23},"end":{"row":22,"column":24},"action":"insert","lines":["r"]},{"start":{"row":22,"column":24},"end":{"row":22,"column":25},"action":"insert","lines":["r"]},{"start":{"row":22,"column":25},"end":{"row":22,"column":26},"action":"insert","lines":["a"]},{"start":{"row":22,"column":26},"end":{"row":22,"column":27},"action":"insert","lines":["f"]},{"start":{"row":22,"column":27},"end":{"row":22,"column":28},"action":"insert","lines":["o"]},{"start":{"row":22,"column":28},"end":{"row":22,"column":29},"action":"insert","lines":["r"]},{"start":{"row":22,"column":29},"end":{"row":22,"column":30},"action":"insert","lines":["m"]}],[{"start":{"row":22,"column":30},"end":{"row":22,"column":31},"action":"insert","lines":[" "],"id":453}],[{"start":{"row":22,"column":30},"end":{"row":22,"column":31},"action":"remove","lines":[" "],"id":454}],[{"start":{"row":22,"column":29},"end":{"row":22,"column":30},"action":"remove","lines":["m"],"id":455},{"start":{"row":22,"column":28},"end":{"row":22,"column":29},"action":"remove","lines":["r"]},{"start":{"row":22,"column":27},"end":{"row":22,"column":28},"action":"remove","lines":["o"]},{"start":{"row":22,"column":26},"end":{"row":22,"column":27},"action":"remove","lines":["f"]},{"start":{"row":22,"column":25},"end":{"row":22,"column":26},"action":"remove","lines":["a"]},{"start":{"row":22,"column":24},"end":{"row":22,"column":25},"action":"remove","lines":["r"]},{"start":{"row":22,"column":23},"end":{"row":22,"column":24},"action":"remove","lines":["r"]},{"start":{"row":22,"column":22},"end":{"row":22,"column":23},"action":"remove","lines":["e"]},{"start":{"row":22,"column":21},"end":{"row":22,"column":22},"action":"remove","lines":["t"]}],[{"start":{"row":22,"column":21},"end":{"row":22,"column":22},"action":"insert","lines":["e"],"id":456},{"start":{"row":22,"column":22},"end":{"row":22,"column":23},"action":"insert","lines":["k"]},{"start":{"row":22,"column":23},"end":{"row":22,"column":24},"action":"insert","lines":["s"]}],[{"start":{"row":22,"column":24},"end":{"row":22,"column":25},"action":"insert","lines":[" "],"id":457}],[{"start":{"row":22,"column":24},"end":{"row":22,"column":25},"action":"remove","lines":[" "],"id":458}],[{"start":{"row":22,"column":21},"end":{"row":22,"column":24},"action":"remove","lines":["eks"],"id":459},{"start":{"row":22,"column":21},"end":{"row":22,"column":22},"action":"insert","lines":["e"]},{"start":{"row":22,"column":22},"end":{"row":22,"column":23},"action":"insert","lines":["y"]},{"start":{"row":22,"column":23},"end":{"row":22,"column":24},"action":"insert","lines":["j"]},{"start":{"row":22,"column":24},"end":{"row":22,"column":25},"action":"insert","lines":["o"]}],[{"start":{"row":154,"column":5},"end":{"row":155,"column":0},"action":"insert","lines":["",""],"id":460},{"start":{"row":155,"column":0},"end":{"row":155,"column":4},"action":"insert","lines":["    "]},{"start":{"row":155,"column":4},"end":{"row":156,"column":0},"action":"insert","lines":["",""]},{"start":{"row":156,"column":0},"end":{"row":156,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":156,"column":4},"end":{"row":198,"column":5},"action":"insert","lines":["    custom_node_group = {","      min_size     = 1","      max_size     = 4","      desired_size = 3","","      instance_types = [\"t3.medium\"]","      capacity_type  = \"SPOT\"","      labels = {","        Environment = \"test\"","        GithubRepo  = \"terraform-aws-eks\"","        GithubOrg   = \"terraform-aws-modules\"","      }","","    #   taints = {","    #     dedicated = {","    #       key    = \"dedicated\"","    #       value  = \"gpuGroup\"","    #       effect = \"NO_SCHEDULE\"","    #     }","","","      block_device_mappings = {","        xvda = {","          device_name = \"/dev/xvda\"","          ebs = {","            volume_size           = 100","            volume_type           = \"gp3\"","            iops                  = 3000","            throughput            = 150","            delete_on_termination = true","          }","        }","      }","","      update_config = {","        max_unavailable_percentage = 33 # or set `max_unavailable`","      }","","      tags = {","        ExtraTag = \"example\"","      }","    }","    }"],"id":461}],[{"start":{"row":156,"column":4},"end":{"row":156,"column":8},"action":"remove","lines":["    "],"id":462}],[{"start":{"row":156,"column":21},"end":{"row":156,"column":22},"action":"insert","lines":["2"],"id":463}],[{"start":{"row":156,"column":21},"end":{"row":156,"column":22},"action":"remove","lines":["2"],"id":464}],[{"start":{"row":156,"column":21},"end":{"row":156,"column":22},"action":"insert","lines":["_"],"id":465},{"start":{"row":156,"column":22},"end":{"row":156,"column":23},"action":"insert","lines":["2"]}],[{"start":{"row":154,"column":4},"end":{"row":154,"column":5},"action":"remove","lines":["}"],"id":466},{"start":{"row":154,"column":0},"end":{"row":154,"column":4},"action":"remove","lines":["    "]},{"start":{"row":153,"column":5},"end":{"row":154,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":196,"column":5},"end":{"row":197,"column":0},"action":"insert","lines":["",""],"id":467},{"start":{"row":197,"column":0},"end":{"row":197,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":198,"column":5},"end":{"row":199,"column":0},"action":"insert","lines":["",""],"id":468},{"start":{"row":199,"column":0},"end":{"row":199,"column":4},"action":"insert","lines":["    "]},{"start":{"row":199,"column":4},"end":{"row":200,"column":0},"action":"insert","lines":["",""]},{"start":{"row":200,"column":0},"end":{"row":200,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":200,"column":0},"end":{"row":200,"column":1},"action":"insert","lines":["#"],"id":469},{"start":{"row":200,"column":1},"end":{"row":200,"column":2},"action":"insert","lines":["E"]},{"start":{"row":200,"column":2},"end":{"row":200,"column":3},"action":"insert","lines":["K"]},{"start":{"row":200,"column":3},"end":{"row":200,"column":4},"action":"insert","lines":["S"]}],[{"start":{"row":200,"column":4},"end":{"row":200,"column":5},"action":"insert","lines":["("],"id":470},{"start":{"row":200,"column":5},"end":{"row":200,"column":6},"action":"insert","lines":[")"]}],[{"start":{"row":197,"column":4},"end":{"row":198,"column":0},"action":"insert","lines":["",""],"id":471},{"start":{"row":198,"column":0},"end":{"row":198,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":198,"column":4},"end":{"row":198,"column":31},"action":"insert","lines":["eks_managed_node_groups = {"],"id":472}],[{"start":{"row":198,"column":4},"end":{"row":198,"column":5},"action":"insert","lines":["#"],"id":473}],[{"start":{"row":198,"column":28},"end":{"row":198,"column":32},"action":"remove","lines":[" = {"],"id":474}],[{"start":{"row":195,"column":7},"end":{"row":196,"column":0},"action":"insert","lines":["",""],"id":475},{"start":{"row":196,"column":0},"end":{"row":196,"column":6},"action":"insert","lines":["      "]},{"start":{"row":196,"column":6},"end":{"row":197,"column":0},"action":"insert","lines":["",""]},{"start":{"row":197,"column":0},"end":{"row":197,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":197,"column":6},"end":{"row":197,"column":25},"action":"insert","lines":["custom_node_group_2"],"id":476}],[{"start":{"row":197,"column":5},"end":{"row":197,"column":6},"action":"remove","lines":[" "],"id":477}],[{"start":{"row":197,"column":5},"end":{"row":197,"column":6},"action":"insert","lines":["#"],"id":478}],[{"start":{"row":197,"column":5},"end":{"row":197,"column":6},"action":"remove","lines":["#"],"id":479},{"start":{"row":197,"column":4},"end":{"row":197,"column":5},"action":"remove","lines":[" "]}],[{"start":{"row":197,"column":4},"end":{"row":197,"column":5},"action":"insert","lines":["#"],"id":480}],[{"start":{"row":158,"column":21},"end":{"row":158,"column":22},"action":"remove","lines":["3"],"id":481}],[{"start":{"row":158,"column":21},"end":{"row":158,"column":22},"action":"insert","lines":["1"],"id":482}],[{"start":{"row":157,"column":21},"end":{"row":157,"column":22},"action":"remove","lines":["4"],"id":483}],[{"start":{"row":157,"column":21},"end":{"row":157,"column":22},"action":"insert","lines":["1"],"id":484}],[{"start":{"row":158,"column":21},"end":{"row":158,"column":22},"action":"remove","lines":["1"],"id":485}],[{"start":{"row":157,"column":21},"end":{"row":157,"column":22},"action":"remove","lines":["1"],"id":486}],[{"start":{"row":157,"column":21},"end":{"row":157,"column":22},"action":"insert","lines":["2"],"id":487}],[{"start":{"row":158,"column":21},"end":{"row":158,"column":22},"action":"insert","lines":["1"],"id":488}],[{"start":{"row":160,"column":28},"end":{"row":160,"column":34},"action":"remove","lines":["medium"],"id":489},{"start":{"row":160,"column":28},"end":{"row":160,"column":29},"action":"insert","lines":["s"]},{"start":{"row":160,"column":29},"end":{"row":160,"column":30},"action":"insert","lines":["m"]},{"start":{"row":160,"column":30},"end":{"row":160,"column":31},"action":"insert","lines":["a"]},{"start":{"row":160,"column":31},"end":{"row":160,"column":32},"action":"insert","lines":["l"]},{"start":{"row":160,"column":32},"end":{"row":160,"column":33},"action":"insert","lines":["l"]}],[{"start":{"row":155,"column":4},"end":{"row":155,"column":6},"action":"insert","lines":["# "],"id":490},{"start":{"row":156,"column":4},"end":{"row":156,"column":6},"action":"insert","lines":["# "]},{"start":{"row":157,"column":4},"end":{"row":157,"column":6},"action":"insert","lines":["# "]},{"start":{"row":158,"column":4},"end":{"row":158,"column":6},"action":"insert","lines":["# "]},{"start":{"row":160,"column":4},"end":{"row":160,"column":6},"action":"insert","lines":["# "]},{"start":{"row":161,"column":4},"end":{"row":161,"column":6},"action":"insert","lines":["# "]},{"start":{"row":162,"column":4},"end":{"row":162,"column":6},"action":"insert","lines":["# "]},{"start":{"row":163,"column":4},"end":{"row":163,"column":6},"action":"insert","lines":["# "]},{"start":{"row":164,"column":4},"end":{"row":164,"column":6},"action":"insert","lines":["# "]},{"start":{"row":165,"column":4},"end":{"row":165,"column":6},"action":"insert","lines":["# "]},{"start":{"row":166,"column":4},"end":{"row":166,"column":6},"action":"insert","lines":["# "]},{"start":{"row":168,"column":4},"end":{"row":168,"column":6},"action":"insert","lines":["# "]},{"start":{"row":169,"column":4},"end":{"row":169,"column":6},"action":"insert","lines":["# "]},{"start":{"row":170,"column":4},"end":{"row":170,"column":6},"action":"insert","lines":["# "]},{"start":{"row":171,"column":4},"end":{"row":171,"column":6},"action":"insert","lines":["# "]},{"start":{"row":172,"column":4},"end":{"row":172,"column":6},"action":"insert","lines":["# "]},{"start":{"row":173,"column":4},"end":{"row":173,"column":6},"action":"insert","lines":["# "]},{"start":{"row":176,"column":4},"end":{"row":176,"column":6},"action":"insert","lines":["# "]},{"start":{"row":177,"column":4},"end":{"row":177,"column":6},"action":"insert","lines":["# "]},{"start":{"row":178,"column":4},"end":{"row":178,"column":6},"action":"insert","lines":["# "]},{"start":{"row":179,"column":4},"end":{"row":179,"column":6},"action":"insert","lines":["# "]},{"start":{"row":180,"column":4},"end":{"row":180,"column":6},"action":"insert","lines":["# "]},{"start":{"row":181,"column":4},"end":{"row":181,"column":6},"action":"insert","lines":["# "]},{"start":{"row":182,"column":4},"end":{"row":182,"column":6},"action":"insert","lines":["# "]},{"start":{"row":183,"column":4},"end":{"row":183,"column":6},"action":"insert","lines":["# "]},{"start":{"row":184,"column":4},"end":{"row":184,"column":6},"action":"insert","lines":["# "]},{"start":{"row":185,"column":4},"end":{"row":185,"column":6},"action":"insert","lines":["# "]},{"start":{"row":186,"column":4},"end":{"row":186,"column":6},"action":"insert","lines":["# "]},{"start":{"row":187,"column":4},"end":{"row":187,"column":6},"action":"insert","lines":["# "]},{"start":{"row":189,"column":4},"end":{"row":189,"column":6},"action":"insert","lines":["# "]},{"start":{"row":190,"column":4},"end":{"row":190,"column":6},"action":"insert","lines":["# "]},{"start":{"row":191,"column":4},"end":{"row":191,"column":6},"action":"insert","lines":["# "]},{"start":{"row":193,"column":4},"end":{"row":193,"column":6},"action":"insert","lines":["# "]},{"start":{"row":194,"column":4},"end":{"row":194,"column":6},"action":"insert","lines":["# "]},{"start":{"row":195,"column":4},"end":{"row":195,"column":6},"action":"insert","lines":["# "]},{"start":{"row":197,"column":4},"end":{"row":197,"column":6},"action":"insert","lines":["# "]},{"start":{"row":198,"column":4},"end":{"row":198,"column":6},"action":"insert","lines":["# "]}],[{"start":{"row":137,"column":38},"end":{"row":137,"column":39},"action":"remove","lines":["0"],"id":491},{"start":{"row":137,"column":37},"end":{"row":137,"column":38},"action":"remove","lines":["0"]},{"start":{"row":137,"column":36},"end":{"row":137,"column":37},"action":"remove","lines":["1"]}],[{"start":{"row":137,"column":36},"end":{"row":137,"column":37},"action":"insert","lines":["1"],"id":492},{"start":{"row":137,"column":37},"end":{"row":137,"column":38},"action":"insert","lines":["1"]},{"start":{"row":137,"column":38},"end":{"row":137,"column":39},"action":"insert","lines":["0"]}],[{"start":{"row":225,"column":0},"end":{"row":225,"column":2},"action":"insert","lines":["# "],"id":493},{"start":{"row":226,"column":0},"end":{"row":226,"column":2},"action":"insert","lines":["# "]},{"start":{"row":227,"column":0},"end":{"row":227,"column":2},"action":"insert","lines":["# "]},{"start":{"row":229,"column":0},"end":{"row":229,"column":2},"action":"insert","lines":["# "]},{"start":{"row":231,"column":0},"end":{"row":231,"column":2},"action":"insert","lines":["# "]},{"start":{"row":232,"column":0},"end":{"row":232,"column":2},"action":"insert","lines":["# "]},{"start":{"row":233,"column":0},"end":{"row":233,"column":2},"action":"insert","lines":["# "]},{"start":{"row":234,"column":0},"end":{"row":234,"column":2},"action":"insert","lines":["# "]},{"start":{"row":236,"column":0},"end":{"row":236,"column":2},"action":"insert","lines":["# "]},{"start":{"row":237,"column":0},"end":{"row":237,"column":2},"action":"insert","lines":["# "]},{"start":{"row":238,"column":0},"end":{"row":238,"column":2},"action":"insert","lines":["# "]},{"start":{"row":239,"column":0},"end":{"row":239,"column":2},"action":"insert","lines":["# "]},{"start":{"row":240,"column":0},"end":{"row":240,"column":2},"action":"insert","lines":["# "]},{"start":{"row":241,"column":0},"end":{"row":241,"column":2},"action":"insert","lines":["# "]},{"start":{"row":243,"column":0},"end":{"row":243,"column":2},"action":"insert","lines":["# "]},{"start":{"row":244,"column":0},"end":{"row":244,"column":2},"action":"insert","lines":["# "]},{"start":{"row":246,"column":0},"end":{"row":246,"column":2},"action":"insert","lines":["# "]},{"start":{"row":247,"column":0},"end":{"row":247,"column":2},"action":"insert","lines":["# "]}],[{"start":{"row":225,"column":0},"end":{"row":225,"column":2},"action":"remove","lines":["# "],"id":494},{"start":{"row":226,"column":0},"end":{"row":226,"column":2},"action":"remove","lines":["# "]},{"start":{"row":227,"column":0},"end":{"row":227,"column":2},"action":"remove","lines":["# "]},{"start":{"row":229,"column":0},"end":{"row":229,"column":2},"action":"remove","lines":["# "]},{"start":{"row":231,"column":0},"end":{"row":231,"column":2},"action":"remove","lines":["# "]},{"start":{"row":232,"column":0},"end":{"row":232,"column":2},"action":"remove","lines":["# "]},{"start":{"row":233,"column":0},"end":{"row":233,"column":2},"action":"remove","lines":["# "]},{"start":{"row":234,"column":0},"end":{"row":234,"column":2},"action":"remove","lines":["# "]},{"start":{"row":236,"column":0},"end":{"row":236,"column":2},"action":"remove","lines":["# "]},{"start":{"row":237,"column":0},"end":{"row":237,"column":2},"action":"remove","lines":["# "]},{"start":{"row":238,"column":0},"end":{"row":238,"column":2},"action":"remove","lines":["# "]},{"start":{"row":239,"column":0},"end":{"row":239,"column":2},"action":"remove","lines":["# "]},{"start":{"row":240,"column":0},"end":{"row":240,"column":2},"action":"remove","lines":["# "]},{"start":{"row":241,"column":0},"end":{"row":241,"column":2},"action":"remove","lines":["# "]},{"start":{"row":243,"column":0},"end":{"row":243,"column":2},"action":"remove","lines":["# "]},{"start":{"row":244,"column":0},"end":{"row":244,"column":2},"action":"remove","lines":["# "]},{"start":{"row":246,"column":0},"end":{"row":246,"column":2},"action":"remove","lines":["# "]},{"start":{"row":247,"column":0},"end":{"row":247,"column":2},"action":"remove","lines":["# "]}],[{"start":{"row":29,"column":40},"end":{"row":30,"column":0},"action":"insert","lines":["",""],"id":495},{"start":{"row":30,"column":0},"end":{"row":30,"column":4},"action":"insert","lines":["    "]},{"start":{"row":30,"column":4},"end":{"row":30,"column":5},"action":"insert","lines":["U"]},{"start":{"row":30,"column":5},"end":{"row":30,"column":6},"action":"insert","lines":["s"]},{"start":{"row":30,"column":6},"end":{"row":30,"column":7},"action":"insert","lines":["e"]},{"start":{"row":30,"column":7},"end":{"row":30,"column":8},"action":"insert","lines":["r"]}],[{"start":{"row":30,"column":8},"end":{"row":30,"column":9},"action":"insert","lines":[" "],"id":496},{"start":{"row":30,"column":9},"end":{"row":30,"column":10},"action":"insert","lines":[" "]},{"start":{"row":30,"column":10},"end":{"row":30,"column":11},"action":"insert","lines":[" "]},{"start":{"row":30,"column":11},"end":{"row":30,"column":12},"action":"insert","lines":[" "]},{"start":{"row":30,"column":12},"end":{"row":30,"column":13},"action":"insert","lines":[" "]},{"start":{"row":30,"column":13},"end":{"row":30,"column":14},"action":"insert","lines":[" "]},{"start":{"row":30,"column":14},"end":{"row":30,"column":15},"action":"insert","lines":[" "]},{"start":{"row":30,"column":15},"end":{"row":30,"column":16},"action":"insert","lines":["="]}],[{"start":{"row":30,"column":16},"end":{"row":30,"column":17},"action":"insert","lines":[" "],"id":497}],[{"start":{"row":30,"column":17},"end":{"row":30,"column":19},"action":"insert","lines":["\"\""],"id":498}],[{"start":{"row":30,"column":18},"end":{"row":30,"column":19},"action":"insert","lines":["e"],"id":499},{"start":{"row":30,"column":19},"end":{"row":30,"column":20},"action":"insert","lines":["y"]},{"start":{"row":30,"column":20},"end":{"row":30,"column":21},"action":"insert","lines":["j"]},{"start":{"row":30,"column":21},"end":{"row":30,"column":22},"action":"insert","lines":["o"]},{"start":{"row":30,"column":22},"end":{"row":30,"column":23},"action":"insert","lines":["@"]},{"start":{"row":30,"column":23},"end":{"row":30,"column":24},"action":"insert","lines":["m"]},{"start":{"row":30,"column":24},"end":{"row":30,"column":25},"action":"insert","lines":["z"]},{"start":{"row":30,"column":25},"end":{"row":30,"column":26},"action":"insert","lines":["."]},{"start":{"row":30,"column":26},"end":{"row":30,"column":27},"action":"insert","lines":["c"]}],[{"start":{"row":30,"column":27},"end":{"row":30,"column":28},"action":"insert","lines":["o"],"id":500},{"start":{"row":30,"column":28},"end":{"row":30,"column":29},"action":"insert","lines":["."]},{"start":{"row":30,"column":29},"end":{"row":30,"column":30},"action":"insert","lines":["k"]},{"start":{"row":30,"column":30},"end":{"row":30,"column":31},"action":"insert","lines":["r"]}],[{"start":{"row":30,"column":31},"end":{"row":30,"column":33},"action":"insert","lines":["\"\""],"id":501}],[{"start":{"row":30,"column":31},"end":{"row":30,"column":33},"action":"remove","lines":["\"\""],"id":502}],[{"start":{"row":138,"column":38},"end":{"row":138,"column":39},"action":"remove","lines":["0"],"id":503},{"start":{"row":138,"column":37},"end":{"row":138,"column":38},"action":"remove","lines":["1"]}],[{"start":{"row":138,"column":37},"end":{"row":138,"column":38},"action":"insert","lines":["0"],"id":504},{"start":{"row":138,"column":38},"end":{"row":138,"column":39},"action":"insert","lines":["0"]}],[{"start":{"row":138,"column":38},"end":{"row":138,"column":39},"action":"remove","lines":["0"],"id":505},{"start":{"row":138,"column":37},"end":{"row":138,"column":38},"action":"remove","lines":["0"]}],[{"start":{"row":138,"column":37},"end":{"row":138,"column":38},"action":"insert","lines":["1"],"id":506},{"start":{"row":138,"column":38},"end":{"row":138,"column":39},"action":"insert","lines":["0"]}],[{"start":{"row":30,"column":0},"end":{"row":30,"column":32},"action":"remove","lines":["    User       = \"eyjo@mz.co.kr\""],"id":507},{"start":{"row":29,"column":40},"end":{"row":30,"column":0},"action":"remove","lines":["",""]}]]},"ace":{"folds":[],"scrolltop":2598,"scrollleft":0,"selection":{"start":{"row":359,"column":49},"end":{"row":359,"column":49},"isBackwards":false},"options":{"tabSize":4,"useSoftTabs":true,"guessTabSize":false,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":184,"state":"start","mode":"ace/mode/terraform"}},"timestamp":1708525188519}